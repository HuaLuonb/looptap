<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Looptap - A minimal game to waste your time</title>
	<link href="style.css" rel="stylesheet" />
	<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
	<script defer src="script.js"></script>
</head>
<body>
	<section id="app">
		<!-- Language Switch -->
		<div id="language-switcher">
			<select v-model="language" @change="changeLanguage">
				<option value="en">English</option>
				<option value="zh">中文</option>
			</select>
		</div>

		<!-- Game Canvas -->
		<section id="canvas">
			<div id="game" style="height: 80vh; display: flex">
				<svg id="looptap" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
					<rect id="bg" x="0" cy="0" height="100" width="100" fill="none" />
					<text
						x="50"
						y="50"
						dominant-baseline="middle"
						text-anchor="middle"
						class="score"
						id="score"
						v-if="state === 'started'"
						v-html="score"
					></text>
					<text
						x="50"
						y="32"
						text-anchor="middle"
						class="score"
						id="finalscore"
						v-if="state === 'stopped'"
						v-html="score"
					></text>
					<text
						x="50"
						y="70"
						text-anchor="middle"
						class="score"
						id="best"
						v-if="state === 'stopped'"
						v-html="t('best') + ': ' + best"
					></text>
					<g id="tip" v-if="state === 'init'">
						<text x="50" y="68" text-anchor="middle" class="tip">{{ t('tip1') }}</text>
						<text x="50" y="74" text-anchor="middle" class="tip">{{ t('tip2') }}</text>
					</g>
					<path
						id="arc"
						fill="none"
						v-bind:stroke="colors[Math.floor(score / 10)] || colors[Math.floor((score - 270) / 10)] || '#bdc3c7'"
						stroke-width="10"
						stroke-linejoin="round"
						stroke-linecap="round"
						v-bind:d="arcDValue"
					/>
					<circle
						id="ball"
						cx="50"
						cy="50"
						r="4"
						fill="#2C3D51"
						v-bind:class="state"
						v-bind:style="'animation-duration: '+(2000 - taps * 5) + 'ms'"
					/>
					<polygon
						id="play"
						points="45,45 55,50 45,55"
						fill="#2C3D51"
						stroke="#2C3D51"
						stroke-width="5"
						stroke-linejoin="round"
						stroke-linecap="round"
						v-if="state !== 'started'"
						v-on:click="startPlay"
					/>
				</svg>
			</div>
			<a
				id="shareBtn"
				v-bind:href="'https://twitter.com/intent/tweet?url=https%3A%2F%2Fvasanthv.github.io%2Flooptap%2F&text=Beat%20my%20score%3A%20'+score+'%0aLooptap%20-%20a%20minimal%20game%20to%20waste%20your%20time.&hashtags=looptap'"
				v-if="['stopped', 'started'].includes(state)"
				target="_blank"
				v-bind:class="state === 'started' ? 'hide' : ''"
			>
				{{ t('share') }}
			</a>
			<div id="about" v-if="state === 'init'">
				{{ t('about1') }}
				<a href="https://twitter.com/vsnthv" target="_blank">Vasanth</a>
				<br />
				{{ t('about2') }}
			</div>
		</section>
	</section>

	<script>
		Vue.createApp({
			data() {
				return {
					state: 'init', // 游戏状态
					score: 0,
					best: 0,
					taps: 0,
					language: 'en', // 默认语言
					translations: {
						en: {
							best: 'Best',
							tip1: 'Tap anywhere / press spacebar when',
							tip2: 'the ball is on the colored area.',
							share: 'Share your score',
							about1: 'Looptap is made by',
							about2: 'A minimal game to waste your time.',
						},
						zh: {
							best: '最高分',
							tip1: '点击任意位置 / 按空格键',
							tip2: '当小球在彩色区域时。',
							share: '分享你的分数',
							about1: 'Looptap 由',
							about2: '一个用来浪费时间的极简游戏。',
						},
					},
				};
			},
			methods: {
				startPlay() {
					this.state = 'started';
				},
				changeLanguage() {
					// 动态切换语言
					localStorage.setItem('language', this.language);
				},
				t(key) {
					// 返回翻译文本
					return this.translations[this.language][key] || key;
				},
			},
			mounted() {
				// 从浏览器或本地存储获取默认语言
				const browserLang = navigator.language.startsWith('zh') ? 'zh' : 'en';
				this.language = localStorage.getItem('language') || browserLang;
			},
		}).mount('#app');
	</script>
</body>
</html>
